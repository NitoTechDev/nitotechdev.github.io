<!DOCTYPE html>
<html>
    <title>NitoTech | Creating an Overlay with Direct3D 9 (Concepts)</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
    <script src="../../blog.js"></script>
    <script src="../../toc.js"></script>
    <body>
        <div class="header poppins-regular">
            <h1>NitoTech</h1>
            <p>Game Vulnerability Researcher | Anti-Cheat Enthusiast</p>
        </div>

        <div class="navbar">
            <a href="../../index.html">Home</a>
            <a href="../../posts.html">Posts</a>
            <a href="../../contact.html" class="right">Contact</a>
        </div>

        <div class="row">
            <div class="blog-side">
                <h2>Check out my <br>other Posts!</h2>
                <h3>My Favorite Projects</h3>
                <p>Here are some of my favorite projects I've worked on</p>
                <div class="mini-posts"><a href="#HackingNioh">Nioh Hack<br>(Under Revisions)</a></div><br>
                <div class="mini-posts"><a href="#SMAT">Static Malware Analysis Tool<br>(Blog in Development)</a></div><br>
                <div class="mini-posts"><a href="./posts/how-do-cheat-overlays-work/">Direct3D 9 Overlay Concepts</a></div>
            </div>
            <div class="blog-main">
                <h1>How do Cheat Overlays Work? (Direct3D 9 Overlay Concept)</h1>
                <h5>Sep 14, 2025 | Direct3D 9 Overlay Concept</h5>
                <hr>
                <h2 id="introduction">Introduction</h2>
                    <p>
                        Have you ever wanted to create an overlay for your cheats and wern't sure where to start? Keep reading, and I will show you how to setup your environment 
                        as well as the concepts behind creating an overlay.
                    </p>
                    <p>
                        Overlays are great because they can help cheat developers as well as potential users of a cheat keep up with specific values or toggled cheats. 
                        Allowing for more clarity on how the cheat operates and it's capabilities.
                    </p>
                    <p>
                        <strong>Disclaimer, this post will speak on the concepts behind creating an overlay for a game.<br></strong>A future post will have code that you can follow along with!
                    </p>
                    <p><strong>Please hover over any words highlighted in purple to get a description of what they mean!</strong></p>
                
                <h2 id="create-an-overlay">What is required to create an overlay?</h2>
                    <p>
                        Things you need:
                    </p>
                    <ul>
                        <li>A game that uses <span class="hover-word">Direct3D 9</span></li>
                        <li>2010 Direct3D 9 <span class="hover-word">SDK</span> (which includes <span class="hover-word">DirectX</span>)</li>
                        <li><span class="hover-word">IDE</span> that is setup for Direct3D's includes and libraries</li>
                    </ul>
                
                <h3 id="which-graphics-api">Identifying what graphics API your game uses</h3>
                    <p>
                        While some games may make the graphics <span class="hover-word">API</span> it uses obvious through launch options, checking the games imports, or by other means. 
                        Sometimes it can be difficult to identify what <span class="hover-word">graphics API</span> a game is using.
                    </p>
                    <p>
                        To address this issue, we can utilize MSI Afterburner. Which you can download from the official 
                        <a href="https://www.msi.com/Landing/afterburner/graphics-cards">MSI website</a>.<br>You'll want to make sure to pay attention and install 
                        <strong>Rivatuner Statistics Server</strong> during the installation process. As it is needed in order to use the overlay within MSI Afterburner
                    </p>
                    <p>After it's been installed, you can follow these instructions to display the graphics API within the overlay:</p> 
                    <ol>
                        <li>Launch the appication, and navigate to <strong>Properties (Cog Wheel Icon)</strong></li>
                        <li>Then you'll go to the <strong>Monitoring</strong> tab and within Graph, scroll down and click on <strong>Frametime</strong></li>
                        <li>
                            Below the Graph, you'll see the check box for <strong>Show in On-Screen Display</strong>, enable that option, 
                            then hit <strong>Apply</strong> and <strong>OK</strong>.
                        </li>
                    </ol>
                    <p>Now the next time you launch a full-screen game, you'll see the graphics API displayed in the top left corner.</p>
                    <p>
                        I learned this technique from "y4k ;; lucky doG" on Steam. Please feel free to check out their original post here: 
                        <a href="https://steamcommunity.com/sharedfiles/filedetails/?id=3223284929">How to find out a game's rendering API with MSI Afterburner</a>
                    </p>

                <h3 id="sdk">Downloading the SDK</h3>
                    <p>You can download the SDK from here: <a href="https://www.microsoft.com/en-us/download/details.aspx?id=6812">Microsoft legacy SDK download</a></p>
                    <p>
                        The SDK has already reached it's End of Life and is no longer supported. If you run into any issues installing the SDK it's usually 
                        because you already have a version of it installed.
                    </p>
                    <p>
                        You'll need to uninstall your current version and run the installer again so you can gaurentee you have DirectX 9 installed which is 
                        included with this installer
                    </p>

                <h3 id="IDE">Setting up your IDE</h3>
                    <p>Within your IDE of choice (I use Visual Studio, so the following instructions are for that IDE)</p>
                    <ol>
                        <li>You can right click on your solution and go to <strong>properties</strong></li>
                        <li>Navigate to <strong>VC++ Directories</strong>, then edit your <strong>Include Directories</strong> to be (ENTER THIS AT A LATER TIME)</li>
                        <li>Then within that same page, you'll edit your <strong>Library Directories</strong> to be (ENTER THIS AT A LATER TIME)</li>
                        <li>
                            Afterwards you can press <strong>apply</strong>, then press <strong>ok</strong>, and your IDE will be setup 
                            to include the Direct3D and DirectX includes and libraries!
                        </li>
                    </ol>
                    <p><strong>These instructions assume you already have a solution created for your cheat.</strong></p>
                
                <h2 id="direct3D">How does a Direct3D overlay work?</h2>

                <h3 id="what-graphics-api-do">What does a Graphics API do?</h3>
                    <p>Before we create our overlay it's important to understand how it works before hand!</p>
                    <p>
                        Direct3D 9 is a Graphics API, that allows us to utilize commands to communicate and control a GPU in order to render images, 2D, and 3D graphics on our screens.
                        Graphic API's vary depending on what operating system you are using as well as what specific software you're using.
                    </p>
                    <p>For example, the Graphics API's utilized by Windows are Direct3D 9 - Direct3D 11.1 as well as OpenGL.</p>
                    <p>To create an overlay we first have to use Direct3D to render new graphics to our screen. So how do we do this?</p>
                    <p>
                        I originally assumed that we would utilize the game's internal engine to render our overlay, which may be possible, but to my current knowledge is not how it works. Instead, we setup an environment very similar to how
                        game engines utilize graphics API's and we interact with our GPU directly to render graphics on top of the game. As mentioned above, since graphics APIs can vary depending on the software of OS we want to make sure that
                        whichever applications we are creating an overlay for uses the same API.
                    </p>

                <h3 id="gather-screen-info">Gathering information about the screen</h3>
                    <p>
                        After we have confirmed that our application uses the same API, we have to gather information about the screen we're rendering to. That can look like something like this:
                    </p>
                    <pre><code>
void Overlay::getGameWindowInfo()
{
	windowInfo.gameWindowHandle = FindWindowA(0, "&lt;Insert Game Window Name&gt;"); // 0 is used to find any top-level window that matches the listed window name

	if (windowInfo.gameWindowHandle)
	{
		GetWindowThreadProcessId(windowInfo.gameWindowHandle, &windowInfo.gameWindowProcID);  // Gets Proccess ID of our targeted Window
		gameHandle = OpenProcess(PROCESS_ALL_ACCESS, false, windowInfo.gameWindowProcID);     // Gets the handle for the Process
		GetWindowRect(windowInfo.gameWindowHandle, &windowInfo.rect);                         // Gets the dimensions of the window
		overlayInfo.width = windowInfo.rect.right - windowInfo.rect.left;                     // Calculate window width
		overlayInfo.height = windowInfo.rect.bottom - windowInfo.rect.top;                    // Calculate window height

		MoveWindow(overlayInfo.overlayWindowHandle, windowInfo.rect.left, windowInfo.rect.top, overlayInfo.width, overlayInfo.height, true); // Used to move our overlay to the targeted area, and paint it over the current window

		overlayInfo.margin = { 0, 0, overlayInfo.width, overlayInfo.height };
	}
}
                    </code></pre>
                    <p>
                        This function is responsible for grabbing information from our games screen, such as the process ID, handle, and the dimensions of our screen. This information will be used later to help us place our overlay
                        properly on the screen.
                    </p>

                <h3 id="create-the-overlay">Creating our overlay</h3>
                    <p>In order to create our overlay we need to create a new Window that we will then show on the screen. We can do this using the <code>CreateWindowEx</code> function. According to MSDN, this function creates an "overlapped, pop-up, or child window with an extended style."</p>
                    <p>We'd then want to utilize <code>SetLayeredWindowAttributes</code> which allows us to set the opacity and transparency color keys of our newly created Window. Then we can show our window using <code>ShowWindow</code> with the <strong>SW_SHOW</strong> flag.</p>
                    <p>The function to do this would look similar to this:</p>
                    <pre><code>
void Overlay::createAndShowOverlay()
{
	overlayInfo.overlayWindowHandle = CreateWindowEx(WS_EX_TOPMOST | WS_EX_LAYERED | WS_EX_TRANSPARENT, L"Cheat Overlay", L"Cheat Overlay", WS_POPUP, 1, 1, overlayInfo.width, overlayInfo.height, 0, 0, hInstance, 0);
	SetLayeredWindowAttributes(overlayInfo.overlayWindowHandle, RGB(0, 0, 0), 255, LWA_COLORKEY | LWA_ALPHA);
	ShowWindow(overlayInfo.overlayWindowHandle, SW_SHOW);
	DwmExtendFrameIntoClientArea(overlayInfo.overlayWindowHandle, &overlayInfo.margin);
}
                    </code></pre>

                <h3 id="initialize-direct3d">Initializing Direct3D</h3>
                    <p>We have to initialize Direct3D 9Ex to create an object which allow us to enumerate and retrieve capabilities of a device.</p>
                    <p>Next, we will go through and interact with a D3D (Direct3D) paramaters structure and set up the paramaters we want for our overlay.</p>
                    <p>Finally, we will create a device, which is how Direct3D communicates with our GPU. Giving it the information we gathered from previous functions along with the parameters we just set.</p>
                    <p>The code for this can look like this: </p>
                    <pre><code>
void Overlay::Direct3D9XInit(HWND hwnd)
{
	hr = Direct3DCreate9Ex(D3D_SDK_VERSION, &m_pObject);     // Creates an IDirect3D9Ex interface to create Direct 3D 9Ex objects

	ZeroMemory(&m_D3DParam, sizeof(m_D3DParam));             // Initializes our D3DPRESENT_PARAMETERS with all zeros

	m_D3DParam.Windowed = true;                              // If application (our game) runs windowed
	m_D3DParam.BackBufferFormat = D3DFMT_A8R8G8B8;           // Defines how color or depth information is stored
	m_D3DParam.BackBufferWidth = overlayInfo.width;          // Width of the new swap chain's back buffer in pixels (Our overlay's width)
	m_D3DParam.BackBufferHeight = overlayInfo.height;        // Height of the new swap chain's back buffer in pixels (Our overlay's height)
	m_D3DParam.EnableAutoDepthStencil = true;                // Makes Direct3D manage depth buffers for the application
	m_D3DParam.AutoDepthStencilFormat = D3DFMT_D16;          // The format of the automatic depth-stencil surface the device will create
	m_D3DParam.SwapEffect = D3DSWAPEFFECT_DISCARD;           // When rendering, this makes it present the back buffer, then discard it

	// Creates a device to represent the display adapter
	hr = m_pObject->CreateDeviceEx(D3DADAPTER_DEFAULT, D3DDEVTYPE_HAL, hwnd, D3DCREATE_HARDWARE_VERTEXPROCESSING, &m_D3DParam, 0, &m_pDevice);
}
                    </code></pre>
                
                <h3 id="render-direct3d">Rendering in Direct3D</h3>
                    <p>The final step of our overlay process, rendering our overlay to the screen.</p>
                    <p>When rendering with Direct3D everything that we are going to render is going to be included between <code>Device->BeginScene()</code> and <br><code>Device->EndScene()</code>.</p>
                    <p>There are so many ways that you can render and draw to a screen and it would be too much to include here. I will include a link to the MSDN where you can see all a wide range of examples of all the things you can draw and make in the references.</p>
                    <p>For example, if we wanted to create a square overlay for our screen we could utilize the <code>D3DXCreateLine()</code> function to initialize the drawing object, and then call the <code>Draw()</code> function from that object.</p>
                    <p>One thing that can be complicated when creating shapes and text on our screen is that everything requires coordinates so that Direct3D can know where we want to draw each of our lines and the style of how we want to connect each vertex.</p>
                    <p>I will be covering rendering a lot more in my future post explaining the code behind creating a cheat overlay. So if you're interested in that, I hope you'll check out that post in the future as well!</p>
                    <p>The last thing we have to do after <code>EndScene()</code> is to call <code>PresentEx()</code> while swaps to the swapchain's next buffer. This enables us to swap out the currently rendered frame with a frame that has been rendered on the back buffer to avoid screen tearing.</p>
                    <p>Afterwards our user will see the newly rendered screen and then we will perform cleanup by calling the <code>Clean()</code> function. Which according to MSDN, "Clears one or more surfaces such as a render target, multiple render targets, a stencil buffer, and a depth buffer".</p>
                    <p>Now we have officially rendered our overlay to the screen!</p>

                <h2 id="conclusion">Conclusion</h2>
                    <p>Now that I have a better understanding on the concept of how creating an overlay for a game cheat works. I will begin to work on creating my own overlay program! It was fun to learn about how much goes into creating an overlay, along with the process that graphic API's play. I hope whoever reads this blog was able to learn something as well!</p>
                    <p>If you have any feedback or want to share what you've created please feel free to reach out! You can contact me through Twitter/X or by the email listed in <a href="../../contact.html">Contacts</a></p>
                    <br>
                    <p>Please take care, take some time to learn something new, and happy game hacking!</p>
                    <p>NitoTech</p>
                
                <h2 id="additional-resources">Additional Resources:</h3>
                    <p>Documentation:</p>
                    <a href="https://learn.microsoft.com/en-us/windows/win32/direct3d9/dx9-graphics">MSDN - Direct3D 9 Graphics</a>
                    <br>
                    <a href="https://learn.microsoft.com/en-us/windows/win32/directx">MSDN - DirectX Graphics</a>

                    <p>Videos:</p>
                    <a href="https://www.youtube.com/watch?v=i8Cn7fydNUA">Guided Hacking - Skyrim Overlay Example</a>
                    <br>
                    <a href="https://www.youtube.com/watch?v=BIZyxja3Qls">CasualGamer - External Overlay in C++</a>
            </div>
            <div id=tocContainer>
                <div id="toc">
                    <ul id="toc-list"></ul>
                </div>
            </div>
        </div>
    </body>
</html>